// example/fasm/boot.ts
org(31744);
use16();
boot: jmp.short.start();
line.db = 0;
bpbOEM.db = "nemesis ";
bpbSectSize.dw = 512;
bpbClustSize.db = 1;
bpbReservedSec.dw = 1;
bpbFats.db = 2;
bpbRootSize.dw = 224;
bpbTotalSect.dw = 2880;
bpbMedia.db = 240;
bpbFatSize.dw = 9;
bpbTrackSect.dw = 18;
bpbHeads.dw = 2;
bpbHiddenSect.dd = 0;
kernel_offset.dw = 0;
kernel_size.dw = 0;
bpbDriveNo.db = 0;
kernel_sec_size.db = 0;
bpbSignature.db = 41;
bpbID.dd = 1;
bpbVolumeLabel.db = "BOOT FLOPPY";
bpbFileSystem.db = "FAT12   ";
equ(kernel_begin, 32256);
start: xor(ax, ax);
mov(ds, ax);
mov(es, ax);
mov(ss, ax);
dec(ax);
mov(sp, ax);
mov(ax, 3);
int(16);
push(loader_name);
push(szloader_name - loader_name);
call(printf);
printf:
  pop(si);
pop(cx);
pop(bp);
push(si);
xor(bh, bh);
mov(ax, 4865);
mov(bl, 2);
cwd();
dh = [line];
int(16);
inc([line]);
cmp([line], 24);
jnz(line_good);
dec([line]);
ax = 1537;
bh = 2;
cx ^= cx;
dx = 6223;
int(16);
line_good:
  ret;
loader_name.db = "Nemesis loader";
szloader_name:
  error_reading.db = "error reading";
